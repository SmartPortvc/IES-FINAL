import{j as s,C as Q,B as H}from"./index-D2y675Iz.js";import{r as _}from"./vendor-Cjg16i2H.js";import{D as Y}from"./DateRangePicker-_xCTB5SA.js";import{G as X,C as G,H as J}from"./ui-D_zlxExx.js";import{w as q,u as $}from"./excelExport-CMCNPtFJ.js";const ae=({onGenerateWeekly:l,onGenerateCustom:x,ports:R,selectedPortId:V="all",onPortChange:P,isAdmin:I=!1,loading:F=!1})=>{var f;const[m,w]=_.useState("weekly"),[A,O]=_.useState(""),[o,C]=_.useState(""),[h,n]=_.useState(V),d=a=>{n(a),P&&P(a)},b=()=>{m==="weekly"?l(h):A&&o?x(A,o,h):alert("Please select both From Date and To Date for custom report")},e=m==="weekly"||A&&o;return s.jsx(Q,{title:"Generate Excel Reports",icon:s.jsx(X,{className:"h-6 w-6 text-seagreen-600"}),className:"mb-6",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex flex-col space-y-4",children:[I&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Port"}),s.jsxs("select",{value:h,onChange:a=>d(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-seagreen-500",children:[s.jsx("option",{value:"all",children:"All Ports"}),R.map(a=>s.jsx("option",{value:a.id,children:a.portName},a.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Report Type"}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("button",{onClick:()=>w("weekly"),className:`flex-1 px-4 py-3 rounded-lg border-2 transition-all ${m==="weekly"?"border-seagreen-500 bg-seagreen-50 text-seagreen-700":"border-gray-200 bg-white text-gray-700 hover:border-gray-300"}`,children:[s.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[s.jsx(G,{className:"h-5 w-5"}),s.jsx("span",{className:"font-medium",children:"Weekly Report"})]}),s.jsx("p",{className:"text-xs mt-1 text-gray-600",children:"Last 7 days from today"})]}),s.jsxs("button",{onClick:()=>w("custom"),className:`flex-1 px-4 py-3 rounded-lg border-2 transition-all ${m==="custom"?"border-seagreen-500 bg-seagreen-50 text-seagreen-700":"border-gray-200 bg-white text-gray-700 hover:border-gray-300"}`,children:[s.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[s.jsx(G,{className:"h-5 w-5"}),s.jsx("span",{className:"font-medium",children:"Custom Report"})]}),s.jsx("p",{className:"text-xs mt-1 text-gray-600",children:"Select date range"})]})]})]}),m==="custom"&&s.jsx("div",{className:"p-4 bg-gray-50 rounded-lg",children:s.jsx(Y,{fromDate:A,toDate:o,onFromDateChange:O,onToDateChange:C,fromLabel:"From Arrival Date",toLabel:"To Arrival Date"})}),m==="weekly"&&s.jsx("div",{className:"p-4 bg-seagreen-50 rounded-lg",children:s.jsxs("div",{className:"flex items-center space-x-2 text-seagreen-700",children:[s.jsx(G,{className:"h-5 w-5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium",children:"Weekly Report Range"}),s.jsxs("p",{className:"text-xs",children:[new Date(Date.now()-7*24*60*60*1e3).toLocaleDateString()," - ",new Date().toLocaleDateString()]})]})]})})]}),s.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[s.jsx("div",{className:"text-sm text-gray-600",children:h==="all"?s.jsx("p",{className:"text-seagreen-600 font-medium",children:"Report will include all ports"}):s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Port:"})," ",((f=R.find(a=>a.id===h))==null?void 0:f.portName)||"Selected Port"]})}),s.jsx(H,{onClick:b,disabled:!e||F,icon:s.jsx(J,{className:"h-4 w-4"}),children:F?"Generating...":`Download ${m==="weekly"?"Weekly":"Custom"} Report`})]})]})})},B=l=>{if(!l)return"-";if(typeof l=="string"){const x=new Date(l);return isNaN(x.getTime())?"-":x.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}return l instanceof Date?l.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):l&&typeof l=="object"&&"seconds"in l?new Date(l.seconds*1e3).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-"},k=l=>typeof l=="number"?l.toLocaleString("en-US",{maximumFractionDigits:2}):l,W=(l,x,R,V,P)=>{const I=new Date,F=new Date(I);F.setDate(I.getDate()-7),F.setHours(0,0,0,0);const m=new Date(I);m.setHours(23,59,59,999);let w,A,O;R==="custom"&&V&&P?(w=new Date(V),w.setHours(0,0,0,0),A=new Date(P),A.setHours(23,59,59,999),O="selected period"):(w=F,A=m,O="last week");const o=(t,c)=>{let g;if(c==="berthing"?g=t.berthingDateTime:c==="departure"?g=t.pobDepartureDateTime||t.sailedOutDate:g=t.arrivalDateTime||t.berthingDateTime,!g)return!1;let i;if(typeof g=="string")i=new Date(g);else if(g instanceof Date)i=g;else if(g.seconds)i=new Date(g.seconds*1e3);else return!1;return i>=w&&i<=A},C=(t,c,g)=>{if(!t)return!1;let i;if(typeof t=="string")i=new Date(t);else if(t instanceof Date)i=t;else if(t.seconds)i=new Date(t.seconds*1e3);else return!1;return i>=c&&i<=g},n=(()=>{const t=new Date,c=t.getDay(),g=c===6?0:c===0?-1:-(c+1),i=new Date(t);i.setDate(t.getDate()+g-7),i.setHours(0,0,0,0);const D=new Date(i);return D.setDate(i.getDate()+6),D.setHours(23,59,59,999),{start:i,end:D}})(),d=l.filter(t=>o(t,"berthing")).length,b=l.filter(t=>t.berthingDateTime).length,e=l.filter(t=>t.pobDepartureDateTime||t.sailedOutDate).length,f=b-e,a=l.filter(t=>{var c,g,i,D;return C(t.berthingDateTime||t.arrivalDateTime,n.start,n.end)&&(((g=(c=t.operationType)==null?void 0:c.toLowerCase())==null?void 0:g.includes("loading"))||((D=(i=t.operation)==null?void 0:i.toLowerCase())==null?void 0:D.includes("loading")))}).length,u=l.filter(t=>{var c,g,i,D;return C(t.berthingDateTime||t.arrivalDateTime,n.start,n.end)&&(((g=(c=t.operationType)==null?void 0:c.toLowerCase())==null?void 0:g.includes("unloading"))||((D=(i=t.operation)==null?void 0:i.toLowerCase())==null?void 0:D.includes("unloading")))}).length,r=l.filter(t=>o(t,"departure")).length,S=l.reduce((t,c)=>{var i;if(c.demurragesCollected&&c.demurragesCollected>0)return t+Number(c.demurragesCollected);if(c.totalRevenue){const D=parseFloat(String(c.totalRevenue));if(!isNaN(D)&&D>0)return t+D}const g=((i=c.dailyCargoDetails)==null?void 0:i.reduce((D,y)=>{const p=Number(y.demurrageCharges)||parseFloat(String(y.demurrageCharges||"0"))||0;return D+p},0))||0;return t+g},0),N=l.reduce((t,c)=>{var D,y;const g=((D=c.dailyCargoDetails)==null?void 0:D.reduce((p,T)=>p+(parseFloat(T.quantity||"0")||0),0))||0,i=((y=c.cargo)==null?void 0:y.volume)||0;return t+(g>0?g:i)},0),E=l.filter(t=>R==="weekly"?C(t.berthingDateTime||t.arrivalDateTime,n.start,n.end):o(t,"arrival")).reduce((t,c)=>{var g,i,D;if(!c.clearanceIssuedOn)return t;if((g=c.dailyCargoDetails)==null||g.forEach(y=>{const p=y.cargoTypeInDetail||y.cargoType||"",T=parseFloat(y.quantity||"0")||0;p.toLowerCase().includes("container")?t.container+=T:p.toLowerCase().includes("break bulk")?t.breakBulk+=T:p.toLowerCase().includes("project")?t.project+=T:p.toLowerCase().includes("liquid")?t.liquid+=T:(p.toLowerCase().includes("dry bulk")||p.toLowerCase().includes("bulk"))&&(t.bulk+=T)}),(i=c.cargo)!=null&&i.volume){const y=((D=c.cargo.type)==null?void 0:D.toLowerCase())||"",p=c.cargo.volume||0;y.includes("container")?t.container+=p:y.includes("break bulk")?t.breakBulk+=p:y.includes("project")?t.project+=p:y.includes("liquid")?t.liquid+=p:y.includes("bulk")&&(t.bulk+=p)}return t},{container:0,breakBulk:0,project:0,liquid:0,bulk:0}),U=l.length,z=l.filter(t=>!!t.clearanceIssuedOn).length;return[{description:`Total number of vessels called in the ${O}`,total:d},{description:"Total number of vessels in the port as on date",total:f},{description:"Total number of vessels loading in the port as on date",total:a},{description:"Total number of vessels unloading in the port as on date",total:u},{description:`Total vessels departed ${O}`,total:r},{description:"Demurrages collected (if any) from the ships by the port",total:k(S)},{description:"Total cargo handled since the start of the financial year",total:k(N)},{description:`Cargo handled in the ${O}`,total:k(E.container+E.breakBulk+E.project+E.liquid+E.bulk)},{description:"Dry Bulk cargo",total:k(E.bulk)},{description:"Break Bulk",total:k(E.breakBulk)},{description:"Container (in TEU & MMT)",total:k(E.container)},{description:"Project cargo",total:k(E.project)},{description:"Liquid cargo",total:k(E.liquid)},{description:"Total number of vessels applied for clearance",total:U},{description:"Total number of clearances issued",total:z}]},j=(l,x,R)=>{l[x]&&(l[x].s=R)},K=(l,x,R,V,P)=>{const I=R==="weekly"?`${new Date(Date.now()-6048e5).toLocaleDateString()} - ${new Date().toLocaleDateString()}`:`${new Date(V).toLocaleDateString()} - ${new Date(P).toLocaleDateString()}`,F=x.reduce((h,n)=>{const d=n.portName||"Unknown Port";return h[d]||(h[d]=[]),h[d].push(n),h},{}),m=[["ALL PORTS - VESSEL MOVEMENT REPORT"],[`Report Period: ${I}`],[`Report Date Range (Arrival): ${I}`],[`Generated on: ${new Date().toLocaleString()}`],[]],w={top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}},A={name:"Calibri",sz:11},O=W(x,"All Ports",R,V,P);m.push(["SUMMARY (ABSTRACT) - ALL PORTS COLLECTIVELY"],[],["S.No","Description","Total Number","Remarks"],...O.map((h,n)=>[n+1,h.description,h.total,""]),[],[]),Object.entries(F).forEach(([h,n])=>{const d=n.filter(e=>e.clearanceIssuedOn),b=n.filter(e=>!e.clearanceIssuedOn);m.push([`${h.toUpperCase()}`],[]),d.length>0&&(m.push(["CLEARED VESSELS"],["S.No","Vessel Name","Owner/Proprietor","LOA (m)","Agent Name","Purpose of Arrival","Berthed Date","Vessel DWT","Type of Cargo","Quantity (MT/TEU)","Loading/Discharging Commenced","Loading/Discharging Completed","Demurrage (₹)","Clearance Issued On"]),d.forEach((e,f)=>{var L,E,U,z,t,c,g,i,D,y;const a=((L=e.dailyCargoDetails)==null?void 0:L.reduce((p,T)=>p+(parseFloat(T.quantity||"0")||0),0))||0,u=a>0?a:((E=e.cargo)==null?void 0:E.volume)||0;let r=0;if(e.demurragesCollected&&e.demurragesCollected>0)r=Number(e.demurragesCollected);else if(e.totalRevenue){const p=parseFloat(String(e.totalRevenue));r=!isNaN(p)&&p>0?p:0}else r=((U=e.dailyCargoDetails)==null?void 0:U.reduce((p,T)=>{const M=Number(T.demurrageCharges)||parseFloat(String(T.demurrageCharges||"0"))||0;return p+M},0))||0;const S=(t=(z=e.dailyCargoDetails)==null?void 0:z[0])==null?void 0:t.date,N=(g=(c=e.dailyCargoDetails)==null?void 0:c[e.dailyCargoDetails.length-1])==null?void 0:g.date;m.push([f+1,e.vesselName||"-",e.vesselOwner||"-",e.loa||"-",e.vesselAgent||"-",e.operation||e.operationType||"-",B(e.berthingDateTime),e.dwt||"-",((i=e.cargo)==null?void 0:i.type)||((y=(D=e.dailyCargoDetails)==null?void 0:D[0])==null?void 0:y.cargoTypeInDetail)||"-",k(u),B(S),B(N),k(r),B(e.clearanceIssuedOn)])}),m.push([])),b.length>0&&(m.push(["UNCLEARED VESSELS (PENDING CLEARANCE)"],["S.No","Vessel Name","Agent Name","Berthed Date","Purpose of Arrival","Demurrage (₹)","Status"]),b.forEach((e,f)=>{var u;let a=0;if(e.demurragesCollected&&e.demurragesCollected>0)a=Number(e.demurragesCollected);else if(e.totalRevenue){const r=parseFloat(String(e.totalRevenue));a=!isNaN(r)&&r>0?r:0}else a=((u=e.dailyCargoDetails)==null?void 0:u.reduce((r,S)=>{const N=Number(S.demurrageCharges)||parseFloat(String(S.demurrageCharges||"0"))||0;return r+N},0))||0;m.push([f+1,e.vesselName||"-",e.vesselAgent||"-",B(e.berthingDateTime),e.operation||e.operationType||"-",k(a),"Pending Clearance"])}),m.push([])),m.push([])});const o=$.aoa_to_sheet(m);o["!cols"]=[{wch:8},{wch:30},{wch:25},{wch:12},{wch:25},{wch:22},{wch:18},{wch:14},{wch:22},{wch:18},{wch:22},{wch:22},{wch:18},{wch:20}];const C=$.decode_range(o["!ref"]||"A1");for(let h=C.s.r;h<=C.e.r;++h)for(let n=C.s.c;n<=C.e.c;++n){const d=$.encode_cell({r:h,c:n});if(!o[d])continue;const b=o[d].v,e=String(b);if(h===0)j(o,d,{font:{name:"Calibri",sz:16,bold:!0,color:{rgb:"1F2937"}},alignment:{horizontal:"left",vertical:"center",wrapText:!1},fill:{fgColor:{rgb:"E0F2FE"}},border:w});else if(h===1||h===2)j(o,d,{font:{name:"Calibri",sz:10,bold:!1,color:{rgb:"4B5563"}},alignment:{horizontal:"left",vertical:"center",wrapText:!1},border:w});else if(e.includes("SUMMARY (ABSTRACT)"))j(o,d,{font:{name:"Calibri",sz:13,bold:!0,color:{rgb:"047857"}},alignment:{horizontal:"left",vertical:"center",wrapText:!1},fill:{fgColor:{rgb:"D1FAE5"}},border:w});else if(e.includes("CLEARED VESSELS")||e.includes("PENDING CLEARANCE")||e.includes("UNCLEARED VESSELS"))j(o,d,{font:{name:"Calibri",sz:12,bold:!0,color:{rgb:"047857"}},alignment:{horizontal:"left",vertical:"center",wrapText:!1},fill:{fgColor:{rgb:"D1FAE5"}},border:w});else if(b&&typeof b=="string"&&b.toUpperCase()===b&&b.length>10&&!e.includes("CLEARED")&&!e.includes("PENDING")&&!e.includes("UNCLEARED")&&!e.includes("SUMMARY"))j(o,d,{font:{name:"Calibri",sz:14,bold:!0,color:{rgb:"0F172A"}},alignment:{horizontal:"left",vertical:"center",wrapText:!1},fill:{fgColor:{rgb:"FEF3C7"}},border:w});else if(e==="S.No"||e==="Description"||e==="Total Number"||e==="Remarks"||e==="Vessel Name"||e==="Owner/Proprietor"||e==="LOA (m)"||e==="Agent Name"||e==="Purpose of Arrival"||e==="Berthed Date"||e==="Vessel DWT"||e==="Type of Cargo"||e==="Quantity (MT/TEU)"||e==="Loading/Discharging Commenced"||e==="Loading/Discharging Completed"||e==="Demurrage (₹)"||e==="Clearance Issued On"||e==="Status")j(o,d,{font:{name:"Calibri",sz:11,bold:!0,color:{rgb:"FFFFFF"}},alignment:{horizontal:"center",vertical:"center",wrapText:!0},fill:{fgColor:{rgb:"14B8A6"}},border:w});else if(b!==""&&b!==null&&b!==void 0){const f=typeof b=="number"||typeof b=="string"&&!isNaN(parseFloat(b.replace(/,/g,""))),a=n===0&&typeof b=="number"&&b<1e3;let u={vertical:"center",wrapText:!0};a?u.horizontal="center":f&&!e.includes("-")&&e!=="-"?u.horizontal="right":u.horizontal="left",j(o,d,{font:a?{...A,bold:!0}:A,alignment:u,border:w})}else j(o,d,{font:A,alignment:{horizontal:"center",vertical:"center",wrapText:!0},border:w})}o["!rows"]=Array(m.length).fill(null).map((h,n)=>{var b,e,f,a,u,r,S,N;if(n===0)return{hpt:35};const d=(b=m[n])==null?void 0:b[0];return typeof d=="string"&&d.toUpperCase()===d&&d.length>10&&!d.includes("CLEARED")&&!d.includes("PENDING")&&!d.includes("UNCLEARED")&&!d.includes("SUMMARY")?{hpt:30}:(e=m[n])!=null&&e.includes("SUMMARY (ABSTRACT)")||(f=m[n])!=null&&f.includes("CLEARED VESSELS")||(a=m[n])!=null&&a.includes("PENDING CLEARANCE")||(u=m[n])!=null&&u.includes("UNCLEARED VESSELS")?{hpt:28}:(r=m[n])!=null&&r.includes("S.No")||(S=m[n])!=null&&S.includes("Vessel Name")||(N=m[n])!=null&&N.includes("Description")?{hpt:28}:{hpt:22}}),o["!margins"]={left:.5,right:.5,top:.75,bottom:.75,header:.3,footer:.3},$.book_append_sheet(l,o,"All Ports Report")},oe=(l,x,R,V,P,I=!1)=>{const F=$.book_new();if(I){K(F,l,R,V,P);const e=`All_Ports_${R}_report_${new Date().toISOString().split("T")[0]}.xlsx`;q(F,e);return}const m=W(l,x,R,V,P),w=l.filter(e=>e.clearanceIssuedOn),A=l.filter(e=>!e.clearanceIssuedOn),O=R==="weekly"?`${new Date(Date.now()-7*24*60*60*1e3).toLocaleDateString()} - ${new Date().toLocaleDateString()}`:`${new Date(V).toLocaleDateString()} - ${new Date(P).toLocaleDateString()}`,o=[[`${x.toUpperCase()} - VESSEL MOVEMENT REPORT`],[`Report Period: ${O}`],[`Generated on: ${new Date().toLocaleString()}`],[],["SUMMARY (ABSTRACT)"],[],["S.No","Description","Total Number","Remarks"],...m.map((e,f)=>[f+1,e.description,e.total,""]),[],[]];o.length,w.length>0&&(o.push(["ANNEXURE - CLEARED VESSELS"],[],["S.No","Vessel Name","Owner/Proprietor","LOA (m)","Agent Name","Purpose of Arrival","Berthed Date","Vessel DWT","Type of Cargo","Quantity (MT/TEU)","Loading/Discharging Commenced","Loading/Discharging Completed","Demurrage (₹)","Clearance Issued On"]),w.forEach((e,f)=>{var L,E,U,z,t,c,g,i,D,y;const a=((L=e.dailyCargoDetails)==null?void 0:L.reduce((p,T)=>p+(parseFloat(T.quantity||"0")||0),0))||0,u=a>0?a:((E=e.cargo)==null?void 0:E.volume)||0;let r=0;if(e.demurragesCollected&&e.demurragesCollected>0)r=Number(e.demurragesCollected);else if(e.totalRevenue){const p=parseFloat(String(e.totalRevenue));r=!isNaN(p)&&p>0?p:0}else r=((U=e.dailyCargoDetails)==null?void 0:U.reduce((p,T)=>{const M=Number(T.demurrageCharges)||parseFloat(String(T.demurrageCharges||"0"))||0;return p+M},0))||0;const S=(t=(z=e.dailyCargoDetails)==null?void 0:z[0])==null?void 0:t.date,N=(g=(c=e.dailyCargoDetails)==null?void 0:c[e.dailyCargoDetails.length-1])==null?void 0:g.date;o.push([f+1,e.vesselName||"-",e.vesselOwner||"-",e.loa||"-",e.vesselAgent||"-",e.operation||e.operationType||"-",B(e.berthingDateTime),e.dwt||"-",((i=e.cargo)==null?void 0:i.type)||((y=(D=e.dailyCargoDetails)==null?void 0:D[0])==null?void 0:y.cargoTypeInDetail)||"-",k(u),B(S),B(N),k(r),B(e.clearanceIssuedOn)])}),o.push([])),A.length>0&&(o.push(["DEPARTURE DATE SECTION - PENDING CLEARANCE"],[],["S.No","Vessel Name","Agent Name","Berthed Date","Purpose of Arrival","Demurrage (₹)","Status"]),A.forEach((e,f)=>{var u;let a=0;if(e.demurragesCollected&&e.demurragesCollected>0)a=Number(e.demurragesCollected);else if(e.totalRevenue){const r=parseFloat(String(e.totalRevenue));a=!isNaN(r)&&r>0?r:0}else a=((u=e.dailyCargoDetails)==null?void 0:u.reduce((r,S)=>{const N=Number(S.demurrageCharges)||parseFloat(String(S.demurrageCharges||"0"))||0;return r+N},0))||0;o.push([f+1,e.vesselName||"-",e.vesselAgent||"-",B(e.berthingDateTime),e.operation||e.operationType||"-",k(a),"Pending Clearance"])}));const C=$.aoa_to_sheet(o);C["!cols"]=[{wch:8},{wch:30},{wch:25},{wch:12},{wch:25},{wch:22},{wch:18},{wch:14},{wch:22},{wch:18},{wch:22},{wch:22},{wch:18},{wch:20}];const h=$.decode_range(C["!ref"]||"A1"),n={top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}},d={name:"Calibri",sz:11};for(let e=h.s.r;e<=h.e.r;++e)for(let f=h.s.c;f<=h.e.c;++f){const a=$.encode_cell({r:e,c:f});if(!C[a])continue;const u=C[a].v,r=String(u);if(e===0)j(C,a,{font:{name:"Calibri",sz:16,bold:!0,color:{rgb:"1F2937"}},alignment:{horizontal:"left",vertical:"center",wrapText:!1},fill:{fgColor:{rgb:"E0F2FE"}},border:n});else if(e===1||e===2)j(C,a,{font:{name:"Calibri",sz:10,bold:!1,color:{rgb:"4B5563"}},alignment:{horizontal:"left",vertical:"center",wrapText:!1},border:n});else if(e===4||r.includes("ANNEXURE")||r.includes("DEPARTURE DATE SECTION"))j(C,a,{font:{name:"Calibri",sz:14,bold:!0,color:{rgb:"047857"}},alignment:{horizontal:"left",vertical:"center",wrapText:!1},fill:{fgColor:{rgb:"D1FAE5"}},border:n});else if(r==="S.No"||r==="Description"||r==="Total Number"||r==="Remarks"||r==="Vessel Name"||r==="Owner/Proprietor"||r==="LOA (m)"||r==="Agent Name"||r==="Purpose of Arrival"||r==="Berthed Date"||r==="Vessel DWT"||r==="Type of Cargo"||r==="Quantity (MT/TEU)"||r==="Loading/Discharging Commenced"||r==="Loading/Discharging Completed"||r==="Demurrage (₹)"||r==="Clearance Issued On"||r==="Status")j(C,a,{font:{name:"Calibri",sz:11,bold:!0,color:{rgb:"FFFFFF"}},alignment:{horizontal:"center",vertical:"center",wrapText:!0},fill:{fgColor:{rgb:"14B8A6"}},border:n});else if(u!==""&&u!==null&&u!==void 0){const S=typeof u=="number"||typeof u=="string"&&!isNaN(parseFloat(u.replace(/,/g,""))),N=f===0&&typeof u=="number"&&u<1e3;let L={vertical:"center",wrapText:!0};N?L.horizontal="center":S&&!r.includes("-")&&r!=="-"?L.horizontal="right":L.horizontal="left",j(C,a,{font:N?{...d,bold:!0}:d,alignment:L,border:n})}else j(C,a,{font:d,alignment:{horizontal:"center",vertical:"center",wrapText:!0},border:n})}C["!rows"]=Array(o.length).fill(null).map((e,f)=>{var a,u,r,S,N,L,E,U,z;return f===0?{hpt:35}:f===4||(r=(u=(a=o[f])==null?void 0:a[0])==null?void 0:u.includes)!=null&&r.call(u,"ANNEXURE")||(L=(N=(S=o[f])==null?void 0:S[0])==null?void 0:N.includes)!=null&&L.call(N,"DEPARTURE")?{hpt:30}:(E=o[f])!=null&&E.includes("S.No")||(U=o[f])!=null&&U.includes("Description")||(z=o[f])!=null&&z.includes("Vessel Name")?{hpt:28}:{hpt:22}}),C["!margins"]={left:.5,right:.5,top:.75,bottom:.75,header:.3,footer:.3},$.book_append_sheet(F,C,"Vessel Report");const b=`${x.replace(/\s+/g,"_")}_${R}_report_${new Date().toISOString().split("T")[0]}.xlsx`;q(F,b)};export{ae as E,oe as g};
//# sourceMappingURL=excelReportGenerator-BC_hGkN_.js.map
