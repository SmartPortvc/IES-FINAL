{"version":3,"file":"excelReportGenerator-BC_hGkN_.js","sources":["../../src/components/reports/ExcelReportGenerator.tsx","../../src/utils/excelReportGenerator.ts"],"sourcesContent":["import React, { useState } from 'react';\nimport { Download, Calendar, FileSpreadsheet } from 'lucide-react';\nimport Card from '../ui/Card';\nimport Button from '../ui/Button';\nimport DateRangePicker from '../ui/DateRangePicker';\n\ninterface ExcelReportGeneratorProps {\n  onGenerateWeekly: (portId: string) => void;\n  onGenerateCustom: (fromDate: string, toDate: string, portId: string) => void;\n  ports: Array<{ id?: string; portName: string }>;\n  selectedPortId?: string;\n  onPortChange?: (portId: string) => void;\n  isAdmin?: boolean;\n  loading?: boolean;\n}\n\nconst ExcelReportGenerator: React.FC<ExcelReportGeneratorProps> = ({\n  onGenerateWeekly,\n  onGenerateCustom,\n  ports,\n  selectedPortId = 'all',\n  onPortChange,\n  isAdmin = false,\n  loading = false,\n}) => {\n  const [reportType, setReportType] = useState<'weekly' | 'custom'>('weekly');\n  const [fromDate, setFromDate] = useState('');\n  const [toDate, setToDate] = useState('');\n  const [localPortId, setLocalPortId] = useState(selectedPortId);\n\n  const handlePortChange = (portId: string) => {\n    setLocalPortId(portId);\n    if (onPortChange) {\n      onPortChange(portId);\n    }\n  };\n\n  const handleGenerateReport = () => {\n    if (reportType === 'weekly') {\n      onGenerateWeekly(localPortId);\n    } else {\n      if (fromDate && toDate) {\n        onGenerateCustom(fromDate, toDate, localPortId);\n      } else {\n        alert('Please select both From Date and To Date for custom report');\n      }\n    }\n  };\n\n  const canGenerate = reportType === 'weekly' || (fromDate && toDate);\n\n  return (\n    <Card\n      title=\"Generate Excel Reports\"\n      icon={<FileSpreadsheet className=\"h-6 w-6 text-seagreen-600\" />}\n      className=\"mb-6\"\n    >\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col space-y-4\">\n          {isAdmin && (\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Select Port\n              </label>\n              <select\n                value={localPortId}\n                onChange={(e) => handlePortChange(e.target.value)}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-seagreen-500\"\n              >\n                <option value=\"all\">All Ports</option>\n                {ports.map((port) => (\n                  <option key={port.id} value={port.id}>\n                    {port.portName}\n                  </option>\n                ))}\n              </select>\n            </div>\n          )}\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-3\">\n              Report Type\n            </label>\n            <div className=\"flex gap-4\">\n              <button\n                onClick={() => setReportType('weekly')}\n                className={`flex-1 px-4 py-3 rounded-lg border-2 transition-all ${\n                  reportType === 'weekly'\n                    ? 'border-seagreen-500 bg-seagreen-50 text-seagreen-700'\n                    : 'border-gray-200 bg-white text-gray-700 hover:border-gray-300'\n                }`}\n              >\n                <div className=\"flex items-center justify-center space-x-2\">\n                  <Calendar className=\"h-5 w-5\" />\n                  <span className=\"font-medium\">Weekly Report</span>\n                </div>\n                <p className=\"text-xs mt-1 text-gray-600\">\n                  Last 7 days from today\n                </p>\n              </button>\n\n              <button\n                onClick={() => setReportType('custom')}\n                className={`flex-1 px-4 py-3 rounded-lg border-2 transition-all ${\n                  reportType === 'custom'\n                    ? 'border-seagreen-500 bg-seagreen-50 text-seagreen-700'\n                    : 'border-gray-200 bg-white text-gray-700 hover:border-gray-300'\n                }`}\n              >\n                <div className=\"flex items-center justify-center space-x-2\">\n                  <Calendar className=\"h-5 w-5\" />\n                  <span className=\"font-medium\">Custom Report</span>\n                </div>\n                <p className=\"text-xs mt-1 text-gray-600\">\n                  Select date range\n                </p>\n              </button>\n            </div>\n          </div>\n\n          {reportType === 'custom' && (\n            <div className=\"p-4 bg-gray-50 rounded-lg\">\n              <DateRangePicker\n                fromDate={fromDate}\n                toDate={toDate}\n                onFromDateChange={setFromDate}\n                onToDateChange={setToDate}\n                fromLabel=\"From Arrival Date\"\n                toLabel=\"To Arrival Date\"\n              />\n            </div>\n          )}\n\n          {reportType === 'weekly' && (\n            <div className=\"p-4 bg-seagreen-50 rounded-lg\">\n              <div className=\"flex items-center space-x-2 text-seagreen-700\">\n                <Calendar className=\"h-5 w-5\" />\n                <div>\n                  <p className=\"text-sm font-medium\">Weekly Report Range</p>\n                  <p className=\"text-xs\">\n                    {new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toLocaleDateString()} - {new Date().toLocaleDateString()}\n                  </p>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n\n        <div className=\"flex items-center justify-between pt-4 border-t border-gray-200\">\n          <div className=\"text-sm text-gray-600\">\n            {localPortId === 'all' ? (\n              <p className=\"text-seagreen-600 font-medium\">\n                Report will include all ports\n              </p>\n            ) : (\n              <p>\n                <span className=\"font-medium\">Port:</span> {ports.find(p => p.id === localPortId)?.portName || 'Selected Port'}\n              </p>\n            )}\n          </div>\n          <Button\n            onClick={handleGenerateReport}\n            disabled={!canGenerate || loading}\n            icon={<Download className=\"h-4 w-4\" />}\n          >\n            {loading ? 'Generating...' : `Download ${reportType === 'weekly' ? 'Weekly' : 'Custom'} Report`}\n          </Button>\n        </div>\n      </div>\n    </Card>\n  );\n};\n\nexport default ExcelReportGenerator;\n","import * as XLSX from 'xlsx';\n\nexport interface ReportVessel {\n  id?: string;\n  vesselName: string;\n  imo?: string;\n  grt?: string;\n  portName?: string;\n  vesselOwner?: string;\n  vesselAgent?: string;\n  arrivalDateTime?: any;\n  berthingDateTime?: any;\n  sailedOutDate?: any;\n  pobDepartureDateTime?: any;\n  loa?: string;\n  dwt?: string;\n  operation?: string;\n  operationType?: string;\n  voyageType?: string;\n  cargo?: {\n    type?: string;\n    name?: string;\n    volume?: number;\n    units?: string;\n  };\n  totalRevenue?: number;\n  demurragesCollected?: number;\n  clearanceIssuedOn?: any;\n  dailyCargoDetails?: Array<{\n    date?: any;\n    cargoType?: string;\n    cargoTypeInDetail?: string;\n    quantity?: string;\n    demurrageCharges?: string;\n    demurrages?: string;\n    reason?: string;\n  }>;\n  createdAt?: any;\n  addedDate?: any;\n}\n\ninterface WeeklySummaryRow {\n  description: string;\n  total: number | string;\n  remarks?: string;\n}\n\nconst formatFirebaseDate = (timestamp: any): string => {\n  if (!timestamp) return '-';\n  if (typeof timestamp === 'string') {\n    const date = new Date(timestamp);\n    if (isNaN(date.getTime())) return '-';\n    return date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });\n  }\n  if (timestamp instanceof Date) {\n    return timestamp.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });\n  }\n  if (timestamp && typeof timestamp === 'object' && 'seconds' in timestamp) {\n    const date = new Date(timestamp.seconds * 1000);\n    return date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });\n  }\n  return '-';\n};\n\nconst formatNumber = (value: number | string): string | number => {\n  if (typeof value === 'number') {\n    return value.toLocaleString('en-US', { maximumFractionDigits: 2 });\n  }\n  return value;\n};\n\nconst calculateWeeklySummary = (\n  vessels: ReportVessel[],\n  portName: string,\n  reportType: 'weekly' | 'custom',\n  fromDate?: string,\n  toDate?: string\n): WeeklySummaryRow[] => {\n  const now = new Date();\n  const lastWeekStart = new Date(now);\n  lastWeekStart.setDate(now.getDate() - 7);\n  lastWeekStart.setHours(0, 0, 0, 0);\n  const lastWeekEnd = new Date(now);\n  lastWeekEnd.setHours(23, 59, 59, 999);\n\n  let periodStart: Date;\n  let periodEnd: Date;\n  let periodText: string;\n\n  if (reportType === 'custom' && fromDate && toDate) {\n    periodStart = new Date(fromDate);\n    periodStart.setHours(0, 0, 0, 0);\n    periodEnd = new Date(toDate);\n    periodEnd.setHours(23, 59, 59, 999);\n    periodText = 'selected period';\n  } else {\n    periodStart = lastWeekStart;\n    periodEnd = lastWeekEnd;\n    periodText = 'last week';\n  }\n\n  const isInPeriod = (vessel: ReportVessel, dateField: 'berthing' | 'departure' | 'arrival') => {\n    let dateToCheck: any;\n\n    if (dateField === 'berthing') {\n      dateToCheck = vessel.berthingDateTime;\n    } else if (dateField === 'departure') {\n      dateToCheck = vessel.pobDepartureDateTime || vessel.sailedOutDate;\n    } else {\n      dateToCheck = vessel.arrivalDateTime || vessel.berthingDateTime;\n    }\n\n    if (!dateToCheck) return false;\n\n    let date: Date;\n    if (typeof dateToCheck === 'string') {\n      date = new Date(dateToCheck);\n    } else if (dateToCheck instanceof Date) {\n      date = dateToCheck;\n    } else if (dateToCheck.seconds) {\n      date = new Date(dateToCheck.seconds * 1000);\n    } else {\n      return false;\n    }\n\n    return date >= periodStart && date <= periodEnd;\n  };\n\n  const isInDateRange = (dateField: any, rangeStart: Date, rangeEnd: Date) => {\n    if (!dateField) return false;\n\n    let date: Date;\n    if (typeof dateField === 'string') {\n      date = new Date(dateField);\n    } else if (dateField instanceof Date) {\n      date = dateField;\n    } else if (dateField.seconds) {\n      date = new Date(dateField.seconds * 1000);\n    } else {\n      return false;\n    }\n\n    return date >= rangeStart && date <= rangeEnd;\n  };\n\n  const getSaturdayToFridayRange = () => {\n    const today = new Date();\n    const dayOfWeek = today.getDay();\n    const daysToSaturday = dayOfWeek === 6 ? 0 : dayOfWeek === 0 ? -1 : -(dayOfWeek + 1);\n    const lastSaturday = new Date(today);\n    lastSaturday.setDate(today.getDate() + daysToSaturday - 7);\n    lastSaturday.setHours(0, 0, 0, 0);\n    const lastFriday = new Date(lastSaturday);\n    lastFriday.setDate(lastSaturday.getDate() + 6);\n    lastFriday.setHours(23, 59, 59, 999);\n    return { start: lastSaturday, end: lastFriday };\n  };\n\n  const satFriRange = getSaturdayToFridayRange();\n\n  const totalVesselsCalled = vessels.filter(v => isInPeriod(v, 'berthing')).length;\n  const totalBerthedVessels = vessels.filter(v => v.berthingDateTime).length;\n  const totalDepartedVessels = vessels.filter(v => v.pobDepartureDateTime || v.sailedOutDate).length;\n  const totalVesselsInPort = totalBerthedVessels - totalDepartedVessels;\n\n  const totalLoading = vessels.filter(v =>\n    isInDateRange(v.berthingDateTime || v.arrivalDateTime, satFriRange.start, satFriRange.end) &&\n    (v.operationType?.toLowerCase()?.includes('loading') || v.operation?.toLowerCase()?.includes('loading'))\n  ).length;\n\n  const totalUnloading = vessels.filter(v =>\n    isInDateRange(v.berthingDateTime || v.arrivalDateTime, satFriRange.start, satFriRange.end) &&\n    (v.operationType?.toLowerCase()?.includes('unloading') || v.operation?.toLowerCase()?.includes('unloading'))\n  ).length;\n\n  const totalDeparted = vessels.filter(v =>\n    isInPeriod(v, 'departure')\n  ).length;\n\n  const totalDemurrages = vessels.reduce((sum, v) => {\n    // First priority: use pre-calculated demurragesCollected field\n    if (v.demurragesCollected && v.demurragesCollected > 0) {\n      return sum + Number(v.demurragesCollected);\n    }\n    // Second priority: use totalRevenue if available (stored as string in Vessel type)\n    if (v.totalRevenue) {\n      const revenueNum = parseFloat(String(v.totalRevenue));\n      if (!isNaN(revenueNum) && revenueNum > 0) {\n        return sum + revenueNum;\n      }\n    }\n    // Fallback: calculate from daily cargo details (if present)\n    const demurrage = v.dailyCargoDetails?.reduce((dSum, d) => {\n      const chargeValue = Number(d.demurrageCharges) || parseFloat(String(d.demurrageCharges || '0')) || 0;\n      return dSum + chargeValue;\n    }, 0) || 0;\n    return sum + demurrage;\n  }, 0);\n\n  const totalCargoHandled = vessels.reduce((sum, v) => {\n    // First check if dailyCargoDetails exists (for ReportVessel objects)\n    const dailyCargoQty = v.dailyCargoDetails?.reduce((cSum, d) => {\n      return cSum + (parseFloat(d.quantity || '0') || 0);\n    }, 0) || 0;\n\n    // Add cargo.volume from the vessel object (always present in Vessel type)\n    const cargoVolume = v.cargo?.volume || 0;\n\n    // If we have daily cargo details, use that; otherwise use cargo.volume\n    return sum + (dailyCargoQty > 0 ? dailyCargoQty : cargoVolume);\n  }, 0);\n\n  const cargoInPeriod = vessels.filter(v => {\n    if (reportType === 'weekly') {\n      return isInDateRange(v.berthingDateTime || v.arrivalDateTime, satFriRange.start, satFriRange.end);\n    } else {\n      return isInPeriod(v, 'arrival');\n    }\n  });\n\n  const cargoByType = cargoInPeriod.reduce((acc, v) => {\n    if (!v.clearanceIssuedOn) return acc;\n\n    v.dailyCargoDetails?.forEach(d => {\n      const type = d.cargoTypeInDetail || d.cargoType || '';\n      const qty = parseFloat(d.quantity || '0') || 0;\n\n      if (type.toLowerCase().includes('container')) acc.container += qty;\n      else if (type.toLowerCase().includes('break bulk')) acc.breakBulk += qty;\n      else if (type.toLowerCase().includes('project')) acc.project += qty;\n      else if (type.toLowerCase().includes('liquid')) acc.liquid += qty;\n      else if (type.toLowerCase().includes('dry bulk') || type.toLowerCase().includes('bulk')) acc.bulk += qty;\n    });\n\n    if (v.cargo?.volume) {\n      const cargoType = v.cargo.type?.toLowerCase() || '';\n      const cargoQty = v.cargo.volume || 0;\n\n      if (cargoType.includes('container')) acc.container += cargoQty;\n      else if (cargoType.includes('break bulk')) acc.breakBulk += cargoQty;\n      else if (cargoType.includes('project')) acc.project += cargoQty;\n      else if (cargoType.includes('liquid')) acc.liquid += cargoQty;\n      else if (cargoType.includes('bulk')) acc.bulk += cargoQty;\n    }\n\n    return acc;\n  }, { container: 0, breakBulk: 0, project: 0, liquid: 0, bulk: 0 });\n\n  const totalAppliedClearance = vessels.length;\n  const totalIssuedClearance = vessels.filter(v => Boolean(v.clearanceIssuedOn)).length;\n\n  return [\n    {\n      description: `Total number of vessels called in the ${periodText}`,\n      total: totalVesselsCalled,\n    },\n    {\n      description: `Total number of vessels in the port as on date`,\n      total: totalVesselsInPort,\n    },\n    {\n      description: `Total number of vessels loading in the port as on date`,\n      total: totalLoading,\n    },\n    {\n      description: `Total number of vessels unloading in the port as on date`,\n      total: totalUnloading,\n    },\n    {\n      description: `Total vessels departed ${periodText}`,\n      total: totalDeparted,\n    },\n    {\n      description: `Demurrages collected (if any) from the ships by the port`,\n      total: formatNumber(totalDemurrages),\n    },\n    {\n      description: `Total cargo handled since the start of the financial year`,\n      total: formatNumber(totalCargoHandled),\n    },\n    {\n      description: `Cargo handled in the ${periodText}`,\n      total: formatNumber(cargoByType.container + cargoByType.breakBulk + cargoByType.project + cargoByType.liquid + cargoByType.bulk),\n    },\n    { description: `Dry Bulk cargo`, total: formatNumber(cargoByType.bulk) },\n    { description: `Break Bulk`, total: formatNumber(cargoByType.breakBulk) },\n    { description: `Container (in TEU & MMT)`, total: formatNumber(cargoByType.container) },\n    { description: `Project cargo`, total: formatNumber(cargoByType.project) },\n    { description: `Liquid cargo`, total: formatNumber(cargoByType.liquid) },\n    {\n      description: `Total number of vessels applied for clearance`,\n      total: totalAppliedClearance,\n    },\n    {\n      description: `Total number of clearances issued`,\n      total: totalIssuedClearance,\n    },\n  ];\n};\n\nconst applyCellStyle = (\n  ws: XLSX.WorkSheet,\n  cellRef: string,\n  style: {\n    font?: { name?: string; sz?: number; bold?: boolean; color?: { rgb: string } };\n    alignment?: { horizontal?: string; vertical?: string; wrapText?: boolean };\n    fill?: { fgColor: { rgb: string } };\n    border?: {\n      top?: { style: string; color: { rgb: string } };\n      bottom?: { style: string; color: { rgb: string } };\n      left?: { style: string; color: { rgb: string } };\n      right?: { style: string; color: { rgb: string } };\n    };\n  }\n) => {\n  if (!ws[cellRef]) return;\n  ws[cellRef].s = style;\n};\n\nconst generateAllPortsReport = (\n  wb: XLSX.WorkBook,\n  vessels: ReportVessel[],\n  reportType: 'weekly' | 'custom',\n  fromDate?: string,\n  toDate?: string\n) => {\n  const dateRangeText = reportType === 'weekly'\n    ? `${new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toLocaleDateString()} - ${new Date().toLocaleDateString()}`\n    : `${new Date(fromDate!).toLocaleDateString()} - ${new Date(toDate!).toLocaleDateString()}`;\n\n  // Group vessels by port\n  const vesselsByPort = vessels.reduce((acc, vessel) => {\n    const port = vessel.portName || 'Unknown Port';\n    if (!acc[port]) {\n      acc[port] = [];\n    }\n    acc[port].push(vessel);\n    return acc;\n  }, {} as Record<string, ReportVessel[]>);\n\n  const sheetData: any[][] = [\n    ['ALL PORTS - VESSEL MOVEMENT REPORT'],\n    [`Report Period: ${dateRangeText}`],\n    [`Report Date Range (Arrival): ${dateRangeText}`],\n    [`Generated on: ${new Date().toLocaleString()}`],\n    [],\n  ];\n\n  const baseBorder = {\n    top: { style: 'thin', color: { rgb: '000000' } },\n    bottom: { style: 'thin', color: { rgb: '000000' } },\n    left: { style: 'thin', color: { rgb: '000000' } },\n    right: { style: 'thin', color: { rgb: '000000' } },\n  };\n\n  const baseFont = {\n    name: 'Calibri',\n    sz: 11,\n  };\n\n  // Calculate collective Abstract Data for ALL ports together\n  const collectiveAbstract = calculateWeeklySummary(vessels, 'All Ports', reportType, fromDate, toDate);\n\n  sheetData.push(\n    ['SUMMARY (ABSTRACT) - ALL PORTS COLLECTIVELY'],\n    [],\n    ['S.No', 'Description', 'Total Number', 'Remarks'],\n    ...collectiveAbstract.map((row, i) => [i + 1, row.description, row.total, '']),\n    [],\n    [],\n  );\n\n  // Generate section for each port with Cleared and Uncleared vessels\n  Object.entries(vesselsByPort).forEach(([portName, portVessels]) => {\n    const clearedVessels = portVessels.filter(v => v.clearanceIssuedOn);\n    const pendingVessels = portVessels.filter(v => !v.clearanceIssuedOn);\n\n    sheetData.push(\n      [`${portName.toUpperCase()}`],\n      [],\n    );\n\n    if (clearedVessels.length > 0) {\n      sheetData.push(\n        ['CLEARED VESSELS'],\n        [\n          'S.No',\n          'Vessel Name',\n          'Owner/Proprietor',\n          'LOA (m)',\n          'Agent Name',\n          'Purpose of Arrival',\n          'Berthed Date',\n          'Vessel DWT',\n          'Type of Cargo',\n          'Quantity (MT/TEU)',\n          'Loading/Discharging Commenced',\n          'Loading/Discharging Completed',\n          'Demurrage (₹)',\n          'Clearance Issued On',\n        ]\n      );\n\n      clearedVessels.forEach((vessel, i) => {\n        // Calculate total quantity: try dailyCargoDetails first, then fall back to cargo.volume\n        const dailyCargoQty = vessel.dailyCargoDetails?.reduce((sum, d) =>\n          sum + (parseFloat(d.quantity || '0') || 0), 0\n        ) || 0;\n        const totalQty = dailyCargoQty > 0 ? dailyCargoQty : (vessel.cargo?.volume || 0);\n\n        // Calculate demurrages: try demurragesCollected, then totalRevenue (as string), then dailyCargoDetails\n        let totalDem = 0;\n        if (vessel.demurragesCollected && vessel.demurragesCollected > 0) {\n          totalDem = Number(vessel.demurragesCollected);\n        } else if (vessel.totalRevenue) {\n          const revenueNum = parseFloat(String(vessel.totalRevenue));\n          totalDem = !isNaN(revenueNum) && revenueNum > 0 ? revenueNum : 0;\n        } else {\n          totalDem = vessel.dailyCargoDetails?.reduce((sum, d) => {\n            const chargeValue = Number(d.demurrageCharges) || parseFloat(String(d.demurrageCharges || '0')) || 0;\n            return sum + chargeValue;\n          }, 0) || 0;\n        }\n\n        const firstCargoDate = vessel.dailyCargoDetails?.[0]?.date;\n        const lastCargoDate = vessel.dailyCargoDetails?.[vessel.dailyCargoDetails.length - 1]?.date;\n\n        sheetData.push([\n          i + 1,\n          vessel.vesselName || '-',\n          vessel.vesselOwner || '-',\n          vessel.loa || '-',\n          vessel.vesselAgent || '-',\n          vessel.operation || vessel.operationType || '-',\n          formatFirebaseDate(vessel.berthingDateTime),\n          vessel.dwt || '-',\n          vessel.cargo?.type || vessel.dailyCargoDetails?.[0]?.cargoTypeInDetail || '-',\n          formatNumber(totalQty),\n          formatFirebaseDate(firstCargoDate),\n          formatFirebaseDate(lastCargoDate),\n          formatNumber(totalDem),\n          formatFirebaseDate(vessel.clearanceIssuedOn),\n        ]);\n      });\n\n      sheetData.push([]);\n    }\n\n    if (pendingVessels.length > 0) {\n      sheetData.push(\n        ['UNCLEARED VESSELS (PENDING CLEARANCE)'],\n        [\n          'S.No',\n          'Vessel Name',\n          'Agent Name',\n          'Berthed Date',\n          'Purpose of Arrival',\n          'Demurrage (₹)',\n          'Status',\n        ]\n      );\n\n      pendingVessels.forEach((vessel, i) => {\n        // Calculate demurrages: try demurragesCollected, then totalRevenue (as string), then dailyCargoDetails\n        let totalDem = 0;\n        if (vessel.demurragesCollected && vessel.demurragesCollected > 0) {\n          totalDem = Number(vessel.demurragesCollected);\n        } else if (vessel.totalRevenue) {\n          const revenueNum = parseFloat(String(vessel.totalRevenue));\n          totalDem = !isNaN(revenueNum) && revenueNum > 0 ? revenueNum : 0;\n        } else {\n          totalDem = vessel.dailyCargoDetails?.reduce((sum, d) => {\n            const chargeValue = Number(d.demurrageCharges) || parseFloat(String(d.demurrageCharges || '0')) || 0;\n            return sum + chargeValue;\n          }, 0) || 0;\n        }\n\n        sheetData.push([\n          i + 1,\n          vessel.vesselName || '-',\n          vessel.vesselAgent || '-',\n          formatFirebaseDate(vessel.berthingDateTime),\n          vessel.operation || vessel.operationType || '-',\n          formatNumber(totalDem),\n          'Pending Clearance',\n        ]);\n      });\n\n      sheetData.push([]);\n    }\n\n    sheetData.push([]);\n  });\n\n  const ws = XLSX.utils.aoa_to_sheet(sheetData);\n\n  ws['!cols'] = [\n    { wch: 8 },\n    { wch: 30 },\n    { wch: 25 },\n    { wch: 12 },\n    { wch: 25 },\n    { wch: 22 },\n    { wch: 18 },\n    { wch: 14 },\n    { wch: 22 },\n    { wch: 18 },\n    { wch: 22 },\n    { wch: 22 },\n    { wch: 18 },\n    { wch: 20 },\n  ];\n\n  const range = XLSX.utils.decode_range(ws['!ref'] || 'A1');\n\n  for (let R = range.s.r; R <= range.e.r; ++R) {\n    for (let C = range.s.c; C <= range.e.c; ++C) {\n      const cellRef = XLSX.utils.encode_cell({ r: R, c: C });\n      if (!ws[cellRef]) continue;\n\n      const cellValue = ws[cellRef].v;\n      const cellString = String(cellValue);\n\n      if (R === 0) {\n        applyCellStyle(ws, cellRef, {\n          font: { name: 'Calibri', sz: 16, bold: true, color: { rgb: '1F2937' } },\n          alignment: { horizontal: 'left', vertical: 'center', wrapText: false },\n          fill: { fgColor: { rgb: 'E0F2FE' } },\n          border: baseBorder,\n        });\n      } else if (R === 1 || R === 2) {\n        applyCellStyle(ws, cellRef, {\n          font: { name: 'Calibri', sz: 10, bold: false, color: { rgb: '4B5563' } },\n          alignment: { horizontal: 'left', vertical: 'center', wrapText: false },\n          border: baseBorder,\n        });\n      } else if (cellString.includes('SUMMARY (ABSTRACT)')) {\n        applyCellStyle(ws, cellRef, {\n          font: { name: 'Calibri', sz: 13, bold: true, color: { rgb: '047857' } },\n          alignment: { horizontal: 'left', vertical: 'center', wrapText: false },\n          fill: { fgColor: { rgb: 'D1FAE5' } },\n          border: baseBorder,\n        });\n      } else if (cellString.includes('CLEARED VESSELS') || cellString.includes('PENDING CLEARANCE') || cellString.includes('UNCLEARED VESSELS')) {\n        applyCellStyle(ws, cellRef, {\n          font: { name: 'Calibri', sz: 12, bold: true, color: { rgb: '047857' } },\n          alignment: { horizontal: 'left', vertical: 'center', wrapText: false },\n          fill: { fgColor: { rgb: 'D1FAE5' } },\n          border: baseBorder,\n        });\n      } else if (cellValue && typeof cellValue === 'string' && cellValue.toUpperCase() === cellValue && cellValue.length > 10 && !cellString.includes('CLEARED') && !cellString.includes('PENDING') && !cellString.includes('UNCLEARED') && !cellString.includes('SUMMARY')) {\n        applyCellStyle(ws, cellRef, {\n          font: { name: 'Calibri', sz: 14, bold: true, color: { rgb: '0F172A' } },\n          alignment: { horizontal: 'left', vertical: 'center', wrapText: false },\n          fill: { fgColor: { rgb: 'FEF3C7' } },\n          border: baseBorder,\n        });\n      } else if (\n        cellString === 'S.No' ||\n        cellString === 'Description' ||\n        cellString === 'Total Number' ||\n        cellString === 'Remarks' ||\n        cellString === 'Vessel Name' ||\n        cellString === 'Owner/Proprietor' ||\n        cellString === 'LOA (m)' ||\n        cellString === 'Agent Name' ||\n        cellString === 'Purpose of Arrival' ||\n        cellString === 'Berthed Date' ||\n        cellString === 'Vessel DWT' ||\n        cellString === 'Type of Cargo' ||\n        cellString === 'Quantity (MT/TEU)' ||\n        cellString === 'Loading/Discharging Commenced' ||\n        cellString === 'Loading/Discharging Completed' ||\n        cellString === 'Demurrage (₹)' ||\n        cellString === 'Clearance Issued On' ||\n        cellString === 'Status'\n      ) {\n        applyCellStyle(ws, cellRef, {\n          font: { name: 'Calibri', sz: 11, bold: true, color: { rgb: 'FFFFFF' } },\n          alignment: { horizontal: 'center', vertical: 'center', wrapText: true },\n          fill: { fgColor: { rgb: '14B8A6' } },\n          border: baseBorder,\n        });\n      } else if (cellValue !== '' && cellValue !== null && cellValue !== undefined) {\n        const isNumeric = typeof cellValue === 'number' ||\n                         (typeof cellValue === 'string' && !isNaN(parseFloat(cellValue.replace(/,/g, ''))));\n\n        const isSerialNumber = C === 0 && typeof cellValue === 'number' && cellValue < 1000;\n\n        let alignment: any = { vertical: 'center', wrapText: true };\n\n        if (isSerialNumber) {\n          alignment.horizontal = 'center';\n        } else if (isNumeric && !cellString.includes('-') && cellString !== '-') {\n          alignment.horizontal = 'right';\n        } else {\n          alignment.horizontal = 'left';\n        }\n\n        applyCellStyle(ws, cellRef, {\n          font: isSerialNumber ? { ...baseFont, bold: true } : baseFont,\n          alignment,\n          border: baseBorder,\n        });\n      } else {\n        applyCellStyle(ws, cellRef, {\n          font: baseFont,\n          alignment: { horizontal: 'center', vertical: 'center', wrapText: true },\n          border: baseBorder,\n        });\n      }\n    }\n  }\n\n  ws['!rows'] = Array(sheetData.length).fill(null).map((_, i) => {\n    if (i === 0) return { hpt: 35 };\n    const cellValue = sheetData[i]?.[0];\n    if (typeof cellValue === 'string' && cellValue.toUpperCase() === cellValue && cellValue.length > 10 && !cellValue.includes('CLEARED') && !cellValue.includes('PENDING') && !cellValue.includes('UNCLEARED') && !cellValue.includes('SUMMARY')) {\n      return { hpt: 30 };\n    }\n    if (\n      sheetData[i]?.includes('SUMMARY (ABSTRACT)') ||\n      sheetData[i]?.includes('CLEARED VESSELS') ||\n      sheetData[i]?.includes('PENDING CLEARANCE') ||\n      sheetData[i]?.includes('UNCLEARED VESSELS')\n    ) {\n      return { hpt: 28 };\n    }\n    if (sheetData[i]?.includes('S.No') || sheetData[i]?.includes('Vessel Name') || sheetData[i]?.includes('Description')) {\n      return { hpt: 28 };\n    }\n    return { hpt: 22 };\n  });\n\n  ws['!margins'] = { left: 0.5, right: 0.5, top: 0.75, bottom: 0.75, header: 0.3, footer: 0.3 };\n\n  XLSX.utils.book_append_sheet(wb, ws, 'All Ports Report');\n};\n\nexport const generateExcelReport = (\n  vessels: ReportVessel[],\n  portName: string,\n  reportType: 'weekly' | 'custom',\n  fromDate?: string,\n  toDate?: string,\n  isAllPorts: boolean = false\n) => {\n  const wb = XLSX.utils.book_new();\n\n  // If All Ports is selected, generate grouped report\n  if (isAllPorts) {\n    generateAllPortsReport(wb, vessels, reportType, fromDate, toDate);\n    const fileName = `All_Ports_${reportType}_report_${new Date().toISOString().split('T')[0]}.xlsx`;\n    XLSX.writeFile(wb, fileName);\n    return;\n  }\n\n  const summary = calculateWeeklySummary(vessels, portName, reportType, fromDate, toDate);\n  const clearedVessels = vessels.filter(v => v.clearanceIssuedOn);\n  const pendingVessels = vessels.filter(v => !v.clearanceIssuedOn);\n\n  const dateRangeText = reportType === 'weekly'\n    ? `${new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toLocaleDateString()} - ${new Date().toLocaleDateString()}`\n    : `${new Date(fromDate!).toLocaleDateString()} - ${new Date(toDate!).toLocaleDateString()}`;\n\n  const sheetData: any[][] = [\n    [`${portName.toUpperCase()} - VESSEL MOVEMENT REPORT`],\n    [`Report Period: ${dateRangeText}`],\n    [`Generated on: ${new Date().toLocaleString()}`],\n    [],\n    ['SUMMARY (ABSTRACT)'],\n    [],\n    ['S.No', 'Description', 'Total Number', 'Remarks'],\n    ...summary.map((row, i) => [i + 1, row.description, row.total, '']),\n    [],\n    [],\n  ];\n\n  let currentRow = sheetData.length;\n\n  if (clearedVessels.length > 0) {\n    sheetData.push(\n      ['ANNEXURE - CLEARED VESSELS'],\n      [],\n      [\n        'S.No',\n        'Vessel Name',\n        'Owner/Proprietor',\n        'LOA (m)',\n        'Agent Name',\n        'Purpose of Arrival',\n        'Berthed Date',\n        'Vessel DWT',\n        'Type of Cargo',\n        'Quantity (MT/TEU)',\n        'Loading/Discharging Commenced',\n        'Loading/Discharging Completed',\n        'Demurrage (₹)',\n        'Clearance Issued On',\n      ]\n    );\n\n    clearedVessels.forEach((vessel, i) => {\n      // Calculate total quantity: try dailyCargoDetails first, then fall back to cargo.volume\n      const dailyCargoQty = vessel.dailyCargoDetails?.reduce((sum, d) =>\n        sum + (parseFloat(d.quantity || '0') || 0), 0\n      ) || 0;\n      const totalQty = dailyCargoQty > 0 ? dailyCargoQty : (vessel.cargo?.volume || 0);\n\n      // Calculate demurrages: try demurragesCollected, then totalRevenue (as string), then dailyCargoDetails\n      let totalDem = 0;\n      if (vessel.demurragesCollected && vessel.demurragesCollected > 0) {\n        totalDem = Number(vessel.demurragesCollected);\n      } else if (vessel.totalRevenue) {\n        const revenueNum = parseFloat(String(vessel.totalRevenue));\n        totalDem = !isNaN(revenueNum) && revenueNum > 0 ? revenueNum : 0;\n      } else {\n        totalDem = vessel.dailyCargoDetails?.reduce((sum, d) => {\n          const chargeValue = Number(d.demurrageCharges) || parseFloat(String(d.demurrageCharges || '0')) || 0;\n          return sum + chargeValue;\n        }, 0) || 0;\n      }\n\n      const firstCargoDate = vessel.dailyCargoDetails?.[0]?.date;\n      const lastCargoDate = vessel.dailyCargoDetails?.[vessel.dailyCargoDetails.length - 1]?.date;\n\n      sheetData.push([\n        i + 1,\n        vessel.vesselName || '-',\n        vessel.vesselOwner || '-',\n        vessel.loa || '-',\n        vessel.vesselAgent || '-',\n        vessel.operation || vessel.operationType || '-',\n        formatFirebaseDate(vessel.berthingDateTime),\n        vessel.dwt || '-',\n        vessel.cargo?.type || vessel.dailyCargoDetails?.[0]?.cargoTypeInDetail || '-',\n        formatNumber(totalQty),\n        formatFirebaseDate(firstCargoDate),\n        formatFirebaseDate(lastCargoDate),\n        formatNumber(totalDem),\n        formatFirebaseDate(vessel.clearanceIssuedOn),\n      ]);\n    });\n\n    sheetData.push([]);\n  }\n\n  if (pendingVessels.length > 0) {\n    sheetData.push(\n      ['DEPARTURE DATE SECTION - PENDING CLEARANCE'],\n      [],\n      [\n        'S.No',\n        'Vessel Name',\n        'Agent Name',\n        'Berthed Date',\n        'Purpose of Arrival',\n        'Demurrage (₹)',\n        'Status',\n      ]\n    );\n\n    pendingVessels.forEach((vessel, i) => {\n      // Calculate demurrages: try demurragesCollected, then totalRevenue (as string), then dailyCargoDetails\n      let totalDem = 0;\n      if (vessel.demurragesCollected && vessel.demurragesCollected > 0) {\n        totalDem = Number(vessel.demurragesCollected);\n      } else if (vessel.totalRevenue) {\n        const revenueNum = parseFloat(String(vessel.totalRevenue));\n        totalDem = !isNaN(revenueNum) && revenueNum > 0 ? revenueNum : 0;\n      } else {\n        totalDem = vessel.dailyCargoDetails?.reduce((sum, d) => {\n          const chargeValue = Number(d.demurrageCharges) || parseFloat(String(d.demurrageCharges || '0')) || 0;\n          return sum + chargeValue;\n        }, 0) || 0;\n      }\n\n      sheetData.push([\n        i + 1,\n        vessel.vesselName || '-',\n        vessel.vesselAgent || '-',\n        formatFirebaseDate(vessel.berthingDateTime),\n        vessel.operation || vessel.operationType || '-',\n        formatNumber(totalDem),\n        'Pending Clearance',\n      ]);\n    });\n  }\n\n  const ws = XLSX.utils.aoa_to_sheet(sheetData);\n\n  ws['!cols'] = [\n    { wch: 8 },\n    { wch: 30 },\n    { wch: 25 },\n    { wch: 12 },\n    { wch: 25 },\n    { wch: 22 },\n    { wch: 18 },\n    { wch: 14 },\n    { wch: 22 },\n    { wch: 18 },\n    { wch: 22 },\n    { wch: 22 },\n    { wch: 18 },\n    { wch: 20 },\n  ];\n\n  const range = XLSX.utils.decode_range(ws['!ref'] || 'A1');\n\n  const baseBorder = {\n    top: { style: 'thin', color: { rgb: '000000' } },\n    bottom: { style: 'thin', color: { rgb: '000000' } },\n    left: { style: 'thin', color: { rgb: '000000' } },\n    right: { style: 'thin', color: { rgb: '000000' } },\n  };\n\n  const baseFont = {\n    name: 'Calibri',\n    sz: 11,\n  };\n\n  for (let R = range.s.r; R <= range.e.r; ++R) {\n    for (let C = range.s.c; C <= range.e.c; ++C) {\n      const cellRef = XLSX.utils.encode_cell({ r: R, c: C });\n      if (!ws[cellRef]) continue;\n\n      const cellValue = ws[cellRef].v;\n      const cellString = String(cellValue);\n\n      if (R === 0) {\n        applyCellStyle(ws, cellRef, {\n          font: { name: 'Calibri', sz: 16, bold: true, color: { rgb: '1F2937' } },\n          alignment: { horizontal: 'left', vertical: 'center', wrapText: false },\n          fill: { fgColor: { rgb: 'E0F2FE' } },\n          border: baseBorder,\n        });\n      } else if (R === 1 || R === 2) {\n        applyCellStyle(ws, cellRef, {\n          font: { name: 'Calibri', sz: 10, bold: false, color: { rgb: '4B5563' } },\n          alignment: { horizontal: 'left', vertical: 'center', wrapText: false },\n          border: baseBorder,\n        });\n      } else if (R === 4 || cellString.includes('ANNEXURE') || cellString.includes('DEPARTURE DATE SECTION')) {\n        applyCellStyle(ws, cellRef, {\n          font: { name: 'Calibri', sz: 14, bold: true, color: { rgb: '047857' } },\n          alignment: { horizontal: 'left', vertical: 'center', wrapText: false },\n          fill: { fgColor: { rgb: 'D1FAE5' } },\n          border: baseBorder,\n        });\n      } else if (\n        cellString === 'S.No' ||\n        cellString === 'Description' ||\n        cellString === 'Total Number' ||\n        cellString === 'Remarks' ||\n        cellString === 'Vessel Name' ||\n        cellString === 'Owner/Proprietor' ||\n        cellString === 'LOA (m)' ||\n        cellString === 'Agent Name' ||\n        cellString === 'Purpose of Arrival' ||\n        cellString === 'Berthed Date' ||\n        cellString === 'Vessel DWT' ||\n        cellString === 'Type of Cargo' ||\n        cellString === 'Quantity (MT/TEU)' ||\n        cellString === 'Loading/Discharging Commenced' ||\n        cellString === 'Loading/Discharging Completed' ||\n        cellString === 'Demurrage (₹)' ||\n        cellString === 'Clearance Issued On' ||\n        cellString === 'Status'\n      ) {\n        applyCellStyle(ws, cellRef, {\n          font: { name: 'Calibri', sz: 11, bold: true, color: { rgb: 'FFFFFF' } },\n          alignment: { horizontal: 'center', vertical: 'center', wrapText: true },\n          fill: { fgColor: { rgb: '14B8A6' } },\n          border: baseBorder,\n        });\n      } else if (cellValue !== '' && cellValue !== null && cellValue !== undefined) {\n        const isNumeric = typeof cellValue === 'number' ||\n                         (typeof cellValue === 'string' && !isNaN(parseFloat(cellValue.replace(/,/g, ''))));\n\n        const isSerialNumber = C === 0 && typeof cellValue === 'number' && cellValue < 1000;\n\n        let alignment: any = { vertical: 'center', wrapText: true };\n\n        if (isSerialNumber) {\n          alignment.horizontal = 'center';\n        } else if (isNumeric && !cellString.includes('-') && cellString !== '-') {\n          alignment.horizontal = 'right';\n        } else {\n          alignment.horizontal = 'left';\n        }\n\n        applyCellStyle(ws, cellRef, {\n          font: isSerialNumber ? { ...baseFont, bold: true } : baseFont,\n          alignment,\n          border: baseBorder,\n        });\n      } else {\n        applyCellStyle(ws, cellRef, {\n          font: baseFont,\n          alignment: { horizontal: 'center', vertical: 'center', wrapText: true },\n          border: baseBorder,\n        });\n      }\n    }\n  }\n\n  ws['!rows'] = Array(sheetData.length).fill(null).map((_, i) => {\n    if (i === 0) return { hpt: 35 };\n    if (i === 4 || sheetData[i]?.[0]?.includes?.('ANNEXURE') || sheetData[i]?.[0]?.includes?.('DEPARTURE')) {\n      return { hpt: 30 };\n    }\n    if (\n      sheetData[i]?.includes('S.No') ||\n      sheetData[i]?.includes('Description') ||\n      sheetData[i]?.includes('Vessel Name')\n    ) {\n      return { hpt: 28 };\n    }\n    return { hpt: 22 };\n  });\n\n  ws['!margins'] = { left: 0.5, right: 0.5, top: 0.75, bottom: 0.75, header: 0.3, footer: 0.3 };\n\n  XLSX.utils.book_append_sheet(wb, ws, 'Vessel Report');\n\n  const fileName = `${portName.replace(/\\s+/g, '_')}_${reportType}_report_${new Date().toISOString().split('T')[0]}.xlsx`;\n  XLSX.writeFile(wb, fileName);\n};\n"],"names":["ExcelReportGenerator","onGenerateWeekly","onGenerateCustom","ports","selectedPortId","onPortChange","isAdmin","loading","reportType","setReportType","useState","fromDate","setFromDate","toDate","setToDate","localPortId","setLocalPortId","handlePortChange","portId","handleGenerateReport","canGenerate","jsx","Card","FileSpreadsheet","jsxs","e","port","Calendar","DateRangePicker","_a","p","Button","Download","formatFirebaseDate","timestamp","date","formatNumber","value","calculateWeeklySummary","vessels","portName","now","lastWeekStart","lastWeekEnd","periodStart","periodEnd","periodText","isInPeriod","vessel","dateField","dateToCheck","isInDateRange","rangeStart","rangeEnd","satFriRange","today","dayOfWeek","daysToSaturday","lastSaturday","lastFriday","totalVesselsCalled","v","totalBerthedVessels","totalDepartedVessels","totalVesselsInPort","totalLoading","_b","_d","_c","totalUnloading","totalDeparted","totalDemurrages","sum","revenueNum","demurrage","dSum","d","chargeValue","totalCargoHandled","dailyCargoQty","cSum","cargoVolume","cargoByType","acc","type","qty","cargoType","cargoQty","totalAppliedClearance","totalIssuedClearance","applyCellStyle","ws","cellRef","style","generateAllPortsReport","wb","dateRangeText","vesselsByPort","sheetData","baseBorder","baseFont","collectiveAbstract","row","i","portVessels","clearedVessels","pendingVessels","totalQty","totalDem","firstCargoDate","_e","lastCargoDate","_g","_f","_h","_j","_i","XLSX.utils","range","R","C","cellValue","cellString","isNumeric","isSerialNumber","alignment","_","generateExcelReport","isAllPorts","fileName","XLSX.writeFile","summary"],"mappings":"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"}