import{u as V,j as e,g as J,d as w,a as N,l as W}from"./index-DYPp-ivU.js";import{e as H,d as K,r as s}from"./vendor-BOKTEpvH.js";import{B as P}from"./ui-WwCSzw8y.js";const _=()=>{const{portId:a}=H(),c=K(),{registerPortUser:A}=V(),[S,k]=s.useState(""),[u,C]=s.useState(""),[m,D]=s.useState(""),[g,F]=s.useState(""),[x,L]=s.useState(""),[h,E]=s.useState(""),[p,B]=s.useState(""),[f,R]=s.useState(""),[l,q]=s.useState(""),[b,M]=s.useState(""),[y,j]=s.useState(!1),[n,r]=s.useState(""),[T,U]=s.useState(!1),[v,d]=s.useState(!0);s.useEffect(()=>{(async()=>{if(a)try{const o=await J(w(N,"ports",a));if(o.exists()){const i=o.data();if(i.status==="registered"){r("This port has already been registered."),d(!1);return}if(i.invitationSentAt){const I=new Date(i.invitationSentAt.toDate()),G=Math.abs(new Date().getTime()-I.getTime());if(Math.ceil(G/(1e3*60*60*24))>7){r("This invitation has expired. Please contact the administrator for a new invitation."),d(!1);return}}k(i.portName||""),C(i.email||""),U(!0)}else r("Invalid registration link. Port not found."),d(!1)}catch(o){console.error("Error fetching port data:",o),r("Failed to load port information. Please try again later."),d(!1)}})()},[a]);const z=async t=>{if(t.preventDefault(),l!==b){r("Passwords do not match");return}if(!a||!T||!v){r("Invalid or expired registration link");return}j(!0),r("");try{await W(w(N,"ports",a),{registeredAddress:m,gst:g,pan:x,landAllotted:h,landUtilised:p,unitizedBerths:f,status:"registered",registeredAt:new Date}),await A(u,l,a),P.success("Registration completed successfully!"),c("/port-dashboard")}catch(o){console.error("Error registering port:",o),r("Failed to complete registration. Please try again."),P.error("Registration failed. Please try again.")}finally{j(!1)}};return n&&!v?e.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-8 text-center",children:[e.jsx("div",{className:"text-red-600 mb-4",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Registration Error"}),e.jsx("p",{className:"text-gray-600 mb-6",children:n}),e.jsx("button",{onClick:()=>c("/login"),className:"w-full bg-seagreen-600 hover:bg-seagreen-700 text-white font-medium py-2 px-4 rounded-md",children:"Go to Login"})]})}):e.jsx("div",{className:"min-h-screen bg-gray-100 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("img",{src:"https://apmaritime.in/assets/apmb-B0Lm-J0A.png",alt:"APMB Logo",className:"h-32 w-32 mx-auto mb-6 object-contain rounded-2xl shadow-lg"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Andhra Pradesh Maritime Board (APMB)"}),e.jsx("p",{className:"mt-2 text-xl font-medium text-seagreen-600",children:"Port Registration"})]}),n&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6",children:n}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-8",children:e.jsxs("form",{onSubmit:z,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"portName",className:"block text-gray-700 font-medium mb-2",children:"Port Name"}),e.jsx("input",{type:"text",id:"portName",value:S,disabled:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-md bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-gray-700 font-medium mb-2",children:"Email Address"}),e.jsx("input",{type:"email",id:"email",value:u,disabled:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-md bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"registeredAddress",className:"block text-gray-700 font-medium mb-2",children:"Registered Address"}),e.jsx("textarea",{id:"registeredAddress",value:m,onChange:t=>D(t.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-seagreen-500",rows:3,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"landAllotted",className:"block text-gray-700 font-medium mb-2",children:"Land allocated (acres)"}),e.jsx("input",{type:"text",id:"landAllotted",value:h,onChange:t=>E(t.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-seagreen-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"landUtilised",className:"block text-gray-700 font-medium mb-2",children:"Land utilised (acres)"}),e.jsx("input",{type:"text",id:"landUtilised",value:p,onChange:t=>B(t.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-seagreen-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"gst",className:"block text-gray-700 font-medium mb-2",children:"GST Number"}),e.jsx("input",{type:"text",id:"gst",value:g,onChange:t=>F(t.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-seagreen-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"pan",className:"block text-gray-700 font-medium mb-2",children:"PAN Number"}),e.jsx("input",{type:"text",id:"pan",value:x,onChange:t=>L(t.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-seagreen-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"unitizedBerths",className:"block text-gray-700 font-medium mb-2",children:"No of berths"}),e.jsx("input",{type:"text",id:"unitizedBerths",value:f,onChange:t=>R(t.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-seagreen-500",required:!0})]})]}),e.jsxs("div",{className:"mt-8 border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Create Account"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-gray-700 font-medium mb-2",children:"Password"}),e.jsx("input",{type:"password",id:"password",value:l,onChange:t=>q(t.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-seagreen-500",required:!0,minLength:6})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-gray-700 font-medium mb-2",children:"Confirm Password"}),e.jsx("input",{type:"password",id:"confirmPassword",value:b,onChange:t=>M(t.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-seagreen-500",required:!0,minLength:6})]})]})]}),e.jsx("div",{className:"mt-8",children:e.jsx("button",{type:"submit",disabled:y,className:"w-full bg-seagreen-600 hover:bg-seagreen-700 text-white font-medium py-3 px-4 rounded-md transition duration-300 ease-in-out disabled:opacity-50",children:y?"Registering...":"Complete Registration"})})]})})]})})};export{_ as default};
//# sourceMappingURL=PortRegistration-BZ_8gi5B.js.map
