import{u as R,j as e,g as M,d as y,a as v,l as B}from"./index-DYPp-ivU.js";import{e as O,d as q,r as s}from"./vendor-BOKTEpvH.js";import{B as w}from"./ui-WwCSzw8y.js";const J=()=>{const{hodId:r}=O(),g=q(),{registerHodUser:j}=R(),[x,N]=s.useState(""),[l,D]=s.useState(""),[c,P]=s.useState(""),[m,S]=s.useState(""),[u,k]=s.useState(""),[h,C]=s.useState(""),[f,p]=s.useState(!1),[i,a]=s.useState(""),[E,H]=s.useState(!1),[b,o]=s.useState(!0);s.useEffect(()=>{(async()=>{if(r)try{const n=await M(y(v,"hods",r));if(n.exists()){const d=n.data();if(d.status==="registered"){a("This HOD has already been registered."),o(!1);return}if(d.invitationSentAt){const F=new Date(d.invitationSentAt.toDate()),L=Math.abs(new Date().getTime()-F.getTime());if(Math.ceil(L/(1e3*60*60*24))>7){a("This invitation has expired. Please contact the administrator for a new invitation."),o(!1);return}}N(d.email||""),H(!0)}else a("Invalid registration link. HOD not found."),o(!1)}catch(n){console.error("Error fetching HOD data:",n),a("Failed to load HOD information. Please try again later."),o(!1)}})()},[r]);const A=async t=>{if(t.preventDefault(),u!==h){a("Passwords do not match");return}if(!r||!E||!b){a("Invalid or expired registration link");return}p(!0),a("");try{await B(y(v,"hods",r),{name:l,designation:c,department:m,status:"registered",registeredAt:new Date}),await j(x,u,r,l,c,m),w.success("Registration completed successfully!"),g("/admin")}catch(n){console.error("Error registering HOD:",n),a("Failed to complete registration. Please try again."),w.error("Registration failed. Please try again.")}finally{p(!1)}};return i&&!b?e.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-8 text-center",children:[e.jsx("div",{className:"text-red-600 mb-4",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Registration Error"}),e.jsx("p",{className:"text-gray-600 mb-6",children:i}),e.jsx("button",{onClick:()=>g("/login"),className:"w-full bg-seagreen-600 hover:bg-seagreen-700 text-white font-medium py-2 px-4 rounded-md",children:"Go to Login"})]})}):e.jsx("div",{className:"min-h-screen bg-gray-100 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("img",{src:"https://apmaritime.in/assets/apmb-B0Lm-J0A.png",alt:"APMB Logo",className:"h-32 w-32 mx-auto mb-6 object-contain rounded-2xl shadow-lg"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Andhra Pradesh Maritime Board (APMB)"}),e.jsx("p",{className:"mt-2 text-xl font-medium text-seagreen-600",children:"HOD Registration"})]}),i&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6",children:i}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-8",children:e.jsxs("form",{onSubmit:A,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-gray-700 font-medium mb-2",children:"Email Address"}),e.jsx("input",{type:"email",id:"email",value:x,disabled:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-md bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-gray-700 font-medium mb-2",children:"Full Name"}),e.jsx("input",{type:"text",id:"name",value:l,onChange:t=>D(t.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-seagreen-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"department",className:"block text-gray-700 font-medium mb-2",children:"Department"}),e.jsx("input",{type:"text",id:"department",value:m,onChange:t=>S(t.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-seagreen-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"designation",className:"block text-gray-700 font-medium mb-2",children:"Designation"}),e.jsx("input",{type:"text",id:"designation",value:c,onChange:t=>P(t.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-seagreen-500",required:!0})]})]}),e.jsxs("div",{className:"mt-8 border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Create Account"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-gray-700 font-medium mb-2",children:"Password"}),e.jsx("input",{type:"password",id:"password",value:u,onChange:t=>k(t.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-seagreen-500",required:!0,minLength:6})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-gray-700 font-medium mb-2",children:"Confirm Password"}),e.jsx("input",{type:"password",id:"confirmPassword",value:h,onChange:t=>C(t.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-seagreen-500",required:!0,minLength:6})]})]})]}),e.jsx("div",{className:"mt-8",children:e.jsx("button",{type:"submit",disabled:f,className:"w-full bg-seagreen-600 hover:bg-seagreen-700 text-white font-medium py-3 px-4 rounded-md transition duration-300 ease-in-out disabled:opacity-50",children:f?"Registering...":"Complete Registration"})})]})})]})})};export{J as default};
//# sourceMappingURL=HodRegistration-LrlH65EK.js.map
