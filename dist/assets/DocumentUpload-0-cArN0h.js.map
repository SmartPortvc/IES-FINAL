{"version":3,"file":"DocumentUpload-0-cArN0h.js","sources":["../../src/components/port/DocumentUpload.tsx"],"sourcesContent":["import React, { useState, useRef } from 'react';\nimport { Upload, X, FileText, AlertCircle, Download, Eye, Trash2, File, Calendar } from 'lucide-react';\nimport { toast } from 'react-toastify';\nimport Button from '../ui/Button';\nimport { PortDocument } from '../../types';\n\ninterface DocumentUploadProps {\n  onUpload: (file: File, message: string) => Promise<void>;\n  documents: PortDocument[];\n  onDelete?: (documentId: string) => Promise<void>;\n  readOnly?: boolean;\n}\n\nconst DocumentUpload: React.FC<DocumentUploadProps> = ({\n  onUpload,\n  documents,\n  onDelete,\n  readOnly = false\n}) => {\n  const [uploading, setUploading] = useState(false);\n  const [message, setMessage] = useState('');\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const handleFileSelect = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    // Validate file size (max 5MB)\n    if (file.size > 5 * 1024 * 1024) {\n      toast.error('File size must be less than 5MB');\n      return;\n    }\n\n    // Validate file type\n    const allowedTypes = ['application/pdf', 'image/jpeg', 'image/png', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];\n    if (!allowedTypes.includes(file.type)) {\n      toast.error('Invalid file type. Please upload PDF, JPEG, PNG, or DOC files.');\n      return;\n    }\n\n    try {\n      setUploading(true);\n      await onUpload(file, message);\n      setMessage('');\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n      toast.success('Document uploaded successfully');\n    } catch (error) {\n      console.error('Error uploading document:', error);\n      toast.error('Failed to upload document');\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  const handleDelete = async (documentId: string) => {\n    if (!onDelete) return;\n    \n    try {\n      await onDelete(documentId);\n      toast.success('Document deleted successfully');\n    } catch (error) {\n      console.error('Error deleting document:', error);\n      toast.error('Failed to delete document');\n    }\n  };\n\n  const formatDate = (timestamp: any) => {\n    if (!timestamp) return 'N/A';\n    const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);\n    return new Intl.DateTimeFormat('en-US', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    }).format(date);\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {!readOnly && (\n        <div className=\"bg-gradient-to-br from-seagreen-50 to-emerald-50 rounded-xl p-6 border-2 border-dashed border-seagreen-300\">\n          <div className=\"flex items-start gap-4 mb-4\">\n            <div className=\"p-3 bg-seagreen-100 rounded-lg\">\n              <Upload className=\"h-6 w-6 text-seagreen-700\" />\n            </div>\n            <div>\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-1\">Upload New Document</h3>\n              <p className=\"text-sm text-gray-600\">Add important documents related to port operations</p>\n            </div>\n          </div>\n\n          <div className=\"space-y-4\">\n            <div>\n              <label htmlFor=\"message\" className=\"block text-sm font-semibold text-gray-700 mb-2\">\n                Document Description\n              </label>\n              <input\n                type=\"text\"\n                id=\"message\"\n                value={message}\n                onChange={(e) => setMessage(e.target.value)}\n                className=\"block w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-seagreen-500 focus:ring-2 focus:ring-seagreen-200 transition-all sm:text-sm placeholder:text-gray-400\"\n                placeholder=\"e.g., Port License Certificate, Safety Compliance Document\"\n                maxLength={100}\n              />\n            </div>\n\n            <div className=\"flex flex-col sm:flex-row sm:items-center gap-4\">\n              <input\n                type=\"file\"\n                ref={fileInputRef}\n                onChange={handleFileSelect}\n                className=\"hidden\"\n                accept=\".pdf,.doc,.docx,.jpg,.jpeg,.png\"\n              />\n              <Button\n                onClick={() => fileInputRef.current?.click()}\n                disabled={uploading}\n                loading={uploading}\n                icon={<Upload className=\"h-4 w-4\" />}\n              >\n                {uploading ? 'Uploading...' : 'Select & Upload File'}\n              </Button>\n              <div className=\"flex items-start gap-2 text-sm text-gray-600 bg-white/60 rounded-lg px-3 py-2\">\n                <AlertCircle className=\"h-4 w-4 mt-0.5 flex-shrink-0 text-amber-600\" />\n                <span>Max 5MB â€¢ PDF, DOC, JPEG, PNG supported</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      <div>\n        <div className=\"flex items-center justify-between mb-4\">\n          <div>\n            <h3 className=\"text-base font-semibold text-gray-900\">Uploaded Documents</h3>\n            <p className=\"text-sm text-gray-500 mt-1\">\n              {documents.length} {documents.length === 1 ? 'document' : 'documents'} available\n            </p>\n          </div>\n        </div>\n\n        {documents.length === 0 ? (\n          <div className=\"bg-gray-50 rounded-xl border-2 border-dashed border-gray-200 p-12 text-center\">\n            <div className=\"inline-flex items-center justify-center w-16 h-16 bg-gray-100 rounded-full mb-4\">\n              <FileText className=\"h-8 w-8 text-gray-400\" />\n            </div>\n            <h3 className=\"text-base font-semibold text-gray-900 mb-1\">No documents yet</h3>\n            <p className=\"text-sm text-gray-500 max-w-sm mx-auto\">\n              {readOnly\n                ? 'No documents have been uploaded for this port.'\n                : 'Upload your first document to get started. All documents are securely stored.'}\n            </p>\n          </div>\n        ) : (\n          <div className=\"grid grid-cols-1 gap-4\">\n            {documents.map((doc) => (\n              <div\n                key={doc.id}\n                className=\"group bg-white rounded-xl border border-gray-200 hover:border-seagreen-300 hover:shadow-md transition-all duration-200 p-5\"\n              >\n                <div className=\"flex items-start justify-between gap-4\">\n                  <div className=\"flex items-start gap-4 flex-1 min-w-0\">\n                    <div className=\"flex-shrink-0\">\n                      <div className=\"p-3 bg-gradient-to-br from-seagreen-50 to-emerald-50 rounded-lg group-hover:from-seagreen-100 group-hover:to-emerald-100 transition-colors\">\n                        <File className=\"h-6 w-6 text-seagreen-600\" />\n                      </div>\n                    </div>\n                    <div className=\"flex-1 min-w-0\">\n                      <h4 className=\"text-sm font-semibold text-gray-900 truncate mb-1\">\n                        {doc.fileName}\n                      </h4>\n                      {doc.message && (\n                        <p className=\"text-sm text-gray-600 mb-2 line-clamp-2\">{doc.message}</p>\n                      )}\n                      <div className=\"flex items-center gap-2 text-xs text-gray-500\">\n                        <Calendar className=\"h-3.5 w-3.5\" />\n                        <span>Uploaded {formatDate(doc.uploadedAt)}</span>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"flex items-center gap-2 flex-shrink-0\">\n                    <a\n                      href={doc.url}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                      className=\"inline-flex items-center gap-1.5 px-3 py-2 bg-seagreen-50 hover:bg-seagreen-100 text-seagreen-700 rounded-lg text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-seagreen-500 focus:ring-offset-2\"\n                      title=\"View document\"\n                    >\n                      <Eye className=\"h-4 w-4\" />\n                      <span className=\"hidden sm:inline\">View</span>\n                    </a>\n                    {!readOnly && onDelete && (\n                      <button\n                        onClick={() => handleDelete(doc.id)}\n                        className=\"inline-flex items-center gap-1.5 px-3 py-2 bg-red-50 hover:bg-red-100 text-red-700 rounded-lg text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2\"\n                        title=\"Delete document\"\n                      >\n                        <Trash2 className=\"h-4 w-4\" />\n                        <span className=\"hidden sm:inline\">Delete</span>\n                      </button>\n                    )}\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default DocumentUpload;"],"names":["DocumentUpload","onUpload","documents","onDelete","readOnly","uploading","setUploading","useState","message","setMessage","fileInputRef","useRef","handleFileSelect","e","file","_a","toast","error","handleDelete","documentId","formatDate","timestamp","date","jsxs","jsx","Upload","Button","AlertCircle","FileText","doc","File","Calendar","Eye","Trash2"],"mappings":"8KAaA,MAAMA,EAAgD,CAAC,CACrD,SAAAC,EACA,UAAAC,EACA,SAAAC,EACA,SAAAC,EAAW,EACb,IAAM,CACJ,KAAM,CAACC,EAAWC,CAAY,EAAIC,EAAAA,SAAS,EAAK,EAC1C,CAACC,EAASC,CAAU,EAAIF,EAAAA,SAAS,EAAE,EACnCG,EAAeC,EAAAA,OAAyB,IAAI,EAE5CC,EAAmB,MAAOC,GAA2C,OACzE,MAAMC,GAAOC,EAAAF,EAAE,OAAO,QAAT,YAAAE,EAAiB,GAC9B,GAAI,CAACD,EAAM,OAGX,GAAIA,EAAK,KAAO,EAAI,KAAO,KAAM,CAC/BE,EAAM,MAAM,iCAAiC,EAC7C,MACF,CAIA,GAAI,CADiB,CAAC,kBAAmB,aAAc,YAAa,qBAAsB,yEAAyE,EACjJ,SAASF,EAAK,IAAI,EAAG,CACrCE,EAAM,MAAM,gEAAgE,EAC5E,MACF,CAEA,GAAI,CACFV,EAAa,EAAI,EACjB,MAAML,EAASa,EAAMN,CAAO,EAC5BC,EAAW,EAAE,EACTC,EAAa,UACfA,EAAa,QAAQ,MAAQ,IAE/BM,EAAM,QAAQ,gCAAgC,CAChD,OAASC,EAAO,CACd,QAAQ,MAAM,4BAA6BA,CAAK,EAChDD,EAAM,MAAM,2BAA2B,CACzC,QAAA,CACEV,EAAa,EAAK,CACpB,CACF,EAEMY,EAAe,MAAOC,GAAuB,CACjD,GAAKhB,EAEL,GAAI,CACF,MAAMA,EAASgB,CAAU,EACzBH,EAAM,QAAQ,+BAA+B,CAC/C,OAASC,EAAO,CACd,QAAQ,MAAM,2BAA4BA,CAAK,EAC/CD,EAAM,MAAM,2BAA2B,CACzC,CACF,EAEMI,EAAcC,GAAmB,CACrC,GAAI,CAACA,EAAW,MAAO,MACvB,MAAMC,EAAOD,EAAU,OAASA,EAAU,SAAW,IAAI,KAAKA,CAAS,EACvE,OAAO,IAAI,KAAK,eAAe,QAAS,CACtC,KAAM,UACN,MAAO,OACP,IAAK,UACL,KAAM,UACN,OAAQ,SAAA,CACT,EAAE,OAAOC,CAAI,CAChB,EAEA,OACEC,EAAAA,KAAC,MAAA,CAAI,UAAU,YACZ,SAAA,CAAA,CAACnB,GACAmB,EAAAA,KAAC,MAAA,CAAI,UAAU,6GACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,8BACb,SAAA,CAAAC,EAAAA,IAAC,OAAI,UAAU,iCACb,eAACC,EAAA,CAAO,UAAU,4BAA4B,CAAA,CAChD,SACC,MAAA,CACC,SAAA,CAAAD,EAAAA,IAAC,KAAA,CAAG,UAAU,2CAA2C,SAAA,sBAAmB,EAC5EA,EAAAA,IAAC,IAAA,CAAE,UAAU,wBAAwB,SAAA,oDAAA,CAAkD,CAAA,CAAA,CACzF,CAAA,EACF,EAEAD,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAC,MAAC,QAAA,CAAM,QAAQ,UAAU,UAAU,iDAAiD,SAAA,uBAEpF,EACAA,EAAAA,IAAC,QAAA,CACC,KAAK,OACL,GAAG,UACH,MAAOhB,EACP,SAAWK,GAAMJ,EAAWI,EAAE,OAAO,KAAK,EAC1C,UAAU,gLACV,YAAY,6DACZ,UAAW,GAAA,CAAA,CACb,EACF,EAEAU,EAAAA,KAAC,MAAA,CAAI,UAAU,kDACb,SAAA,CAAAC,EAAAA,IAAC,QAAA,CACC,KAAK,OACL,IAAKd,EACL,SAAUE,EACV,UAAU,SACV,OAAO,iCAAA,CAAA,EAETY,EAAAA,IAACE,EAAA,CACC,QAAS,IAAA,OAAM,OAAAX,EAAAL,EAAa,UAAb,YAAAK,EAAsB,SACrC,SAAUV,EACV,QAASA,EACT,KAAMmB,EAAAA,IAACC,EAAA,CAAO,UAAU,SAAA,CAAU,EAEjC,WAAY,eAAiB,sBAAA,CAAA,EAEhCF,EAAAA,KAAC,MAAA,CAAI,UAAU,gFACb,SAAA,CAAAC,EAAAA,IAACG,EAAA,CAAY,UAAU,6CAAA,CAA8C,EACrEH,EAAAA,IAAC,QAAK,SAAA,yCAAA,CAAuC,CAAA,CAAA,CAC/C,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,EACF,SAGD,MAAA,CACC,SAAA,CAAAA,MAAC,MAAA,CAAI,UAAU,yCACb,SAAAD,EAAAA,KAAC,MAAA,CACC,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAG,UAAU,wCAAwC,SAAA,qBAAkB,EACxED,EAAAA,KAAC,IAAA,CAAE,UAAU,6BACV,SAAA,CAAArB,EAAU,OAAO,IAAEA,EAAU,SAAW,EAAI,WAAa,YAAY,YAAA,CAAA,CACxE,CAAA,CAAA,CACF,CAAA,CACF,EAECA,EAAU,SAAW,EACpBqB,EAAAA,KAAC,MAAA,CAAI,UAAU,gFACb,SAAA,CAAAC,EAAAA,IAAC,OAAI,UAAU,kFACb,eAACI,EAAA,CAAS,UAAU,wBAAwB,CAAA,CAC9C,EACAJ,EAAAA,IAAC,KAAA,CAAG,UAAU,6CAA6C,SAAA,mBAAgB,QAC1E,IAAA,CAAE,UAAU,yCACV,SAAApB,EACG,iDACA,+EAAA,CACN,CAAA,CAAA,CACF,QAEC,MAAA,CAAI,UAAU,yBACZ,SAAAF,EAAU,IAAK2B,GACdL,EAAAA,IAAC,MAAA,CAEC,UAAU,6HAEV,SAAAD,EAAAA,KAAC,MAAA,CAAI,UAAU,yCACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,wCACb,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,gBACb,SAAAA,EAAAA,IAAC,MAAA,CAAI,UAAU,6IACb,SAAAA,EAAAA,IAACM,EAAA,CAAK,UAAU,2BAAA,CAA4B,CAAA,CAC9C,EACF,EACAP,EAAAA,KAAC,MAAA,CAAI,UAAU,iBACb,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAG,UAAU,oDACX,SAAAK,EAAI,SACP,EACCA,EAAI,SACHL,EAAAA,IAAC,KAAE,UAAU,0CAA2C,WAAI,QAAQ,EAEtED,EAAAA,KAAC,MAAA,CAAI,UAAU,gDACb,SAAA,CAAAC,EAAAA,IAACO,EAAA,CAAS,UAAU,aAAA,CAAc,SACjC,OAAA,CAAK,SAAA,CAAA,YAAUX,EAAWS,EAAI,UAAU,CAAA,CAAA,CAAE,CAAA,CAAA,CAC7C,CAAA,CAAA,CACF,CAAA,EACF,EAEAN,EAAAA,KAAC,MAAA,CAAI,UAAU,wCACb,SAAA,CAAAA,EAAAA,KAAC,IAAA,CACC,KAAMM,EAAI,IACV,OAAO,SACP,IAAI,sBACJ,UAAU,iOACV,MAAM,gBAEN,SAAA,CAAAL,EAAAA,IAACQ,EAAA,CAAI,UAAU,SAAA,CAAU,EACzBR,EAAAA,IAAC,OAAA,CAAK,UAAU,mBAAmB,SAAA,MAAA,CAAI,CAAA,CAAA,CAAA,EAExC,CAACpB,GAAYD,GACZoB,EAAAA,KAAC,SAAA,CACC,QAAS,IAAML,EAAaW,EAAI,EAAE,EAClC,UAAU,6MACV,MAAM,kBAEN,SAAA,CAAAL,EAAAA,IAACS,EAAA,CAAO,UAAU,SAAA,CAAU,EAC5BT,EAAAA,IAAC,OAAA,CAAK,UAAU,mBAAmB,SAAA,QAAA,CAAM,CAAA,CAAA,CAAA,CAC3C,CAAA,CAEJ,CAAA,CAAA,CACF,CAAA,EA9CKK,EAAI,EAAA,CAgDZ,CAAA,CACH,CAAA,CAAA,CAEJ,CAAA,EACF,CAEJ"}